"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.validate = validate;
exports["default"] = void 0;

function validate(params) {
  var common = ['host', 'data', 'type'];
  var types = {
    'MX': ['priority'],
    'SRV': ['priority', 'weight', 'port'],
    'TLSA': ['usage', 'selector', 'dtype'],
    'DS': ['tag', 'alg', 'digest'],
    'CAA': ['flags', 'tag']
  };
  if (!params.hasOwnProperty("type")) throw new Error("Record does not have any type");
  if (!types.hasOwnProperty(params.type)) throw new Error("Record have an unknown type");
  var fields = common;
  var special = types[params.type];
  fields.concat(special);
  if (params.hasOwnProperty('id')) fields.push('id');
  if (params.hasOwnProperty('ttl')) fields.push('ttl');

  for (var idx = 0; idx < fields.length; idx++) {
    if (!params.hasOwnProperty(fields[idx])) throw new Error("Record missing required field");
  }

  if (fields.length < Object.keys(params).keys.length) throw new Error("Too many fields in object");
  return true;
}

var _default = DnsRecord;
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9saWIvaW50ZXJmYWNlcy9kbnNyZWNvcmQudHMiXSwibmFtZXMiOlsidmFsaWRhdGUiLCJwYXJhbXMiLCJjb21tb24iLCJ0eXBlcyIsImhhc093blByb3BlcnR5IiwiRXJyb3IiLCJ0eXBlIiwiZmllbGRzIiwic3BlY2lhbCIsImNvbmNhdCIsInB1c2giLCJpZHgiLCJsZW5ndGgiLCJPYmplY3QiLCJrZXlzIiwiRG5zUmVjb3JkIl0sIm1hcHBpbmdzIjoiOzs7Ozs7OztBQTJETyxTQUFTQSxRQUFULENBQWtCQyxNQUFsQixFQUFvQztBQUN2QyxNQUFNQyxNQUFlLEdBQUcsQ0FBQyxNQUFELEVBQVEsTUFBUixFQUFlLE1BQWYsQ0FBeEI7QUFDQSxNQUFNQyxLQUFnQyxHQUFHO0FBQ3JDLFVBQU0sQ0FBQyxVQUFELENBRCtCO0FBRXJDLFdBQU8sQ0FBQyxVQUFELEVBQVksUUFBWixFQUFxQixNQUFyQixDQUY4QjtBQUdyQyxZQUFRLENBQUMsT0FBRCxFQUFVLFVBQVYsRUFBc0IsT0FBdEIsQ0FINkI7QUFJckMsVUFBTSxDQUFDLEtBQUQsRUFBTyxLQUFQLEVBQWEsUUFBYixDQUorQjtBQUtyQyxXQUFPLENBQUMsT0FBRCxFQUFTLEtBQVQ7QUFMOEIsR0FBekM7QUFRQSxNQUFHLENBQUNGLE1BQU0sQ0FBQ0csY0FBUCxDQUFzQixNQUF0QixDQUFKLEVBQ0ksTUFBTSxJQUFJQyxLQUFKLENBQVUsK0JBQVYsQ0FBTjtBQUNKLE1BQUcsQ0FBQ0YsS0FBSyxDQUFDQyxjQUFOLENBQXFCSCxNQUFNLENBQUNLLElBQTVCLENBQUosRUFDSSxNQUFNLElBQUlELEtBQUosQ0FBVSw2QkFBVixDQUFOO0FBRUosTUFBSUUsTUFBTSxHQUFHTCxNQUFiO0FBQ0EsTUFBSU0sT0FBZ0IsR0FBR0wsS0FBSyxDQUFDRixNQUFNLENBQUNLLElBQVIsQ0FBNUI7QUFDQUMsRUFBQUEsTUFBTSxDQUFDRSxNQUFQLENBQWNELE9BQWQ7QUFFQSxNQUFHUCxNQUFNLENBQUNHLGNBQVAsQ0FBc0IsSUFBdEIsQ0FBSCxFQUNJRyxNQUFNLENBQUNHLElBQVAsQ0FBWSxJQUFaO0FBQ0osTUFBR1QsTUFBTSxDQUFDRyxjQUFQLENBQXNCLEtBQXRCLENBQUgsRUFDSUcsTUFBTSxDQUFDRyxJQUFQLENBQVksS0FBWjs7QUFFSixPQUFJLElBQUlDLEdBQUcsR0FBQyxDQUFaLEVBQWVBLEdBQUcsR0FBR0osTUFBTSxDQUFDSyxNQUE1QixFQUFvQ0QsR0FBRyxFQUF2QyxFQUEyQztBQUN2QyxRQUFHLENBQUNWLE1BQU0sQ0FBQ0csY0FBUCxDQUFzQkcsTUFBTSxDQUFDSSxHQUFELENBQTVCLENBQUosRUFDSSxNQUFNLElBQUlOLEtBQUosQ0FBVSwrQkFBVixDQUFOO0FBQ1A7O0FBRUQsTUFBR0UsTUFBTSxDQUFDSyxNQUFQLEdBQWdCQyxNQUFNLENBQUNDLElBQVAsQ0FBWWIsTUFBWixFQUFvQmEsSUFBcEIsQ0FBeUJGLE1BQTVDLEVBQ0ksTUFBTSxJQUFJUCxLQUFKLENBQVUsMkJBQVYsQ0FBTjtBQUVKLFNBQU8sSUFBUDtBQUNIOztlQUVjVSxTIiwic291cmNlc0NvbnRlbnQiOlsiaW50ZXJmYWNlIERuc1JlY29yZEJhc2Uge1xuICAgIGhvc3Q6IHN0cmluZztcbiAgICBkYXRhOiBzdHJpbmc7XG4gICAgdHlwZTogc3RyaW5nO1xuICAgIHR0bD86IG51bWJlcjtcbiAgICBpZD86IG51bWJlcjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBEbnNSZWNvcmRBIGV4dGVuZHMgRG5zUmVjb3JkQmFzZSB7XG4gICAgdHlwZTogXCJBXCI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRG5zUmVjb3JkQUFBQSBleHRlbmRzIERuc1JlY29yZEJhc2Uge1xuICAgIHR5cGU6IFwiQUFBQVwiO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIERuc1JlY29yZENuYW1lIGV4dGVuZHMgRG5zUmVjb3JkQmFzZSB7XG4gICAgdHlwZTogXCJDQU5NRVwiO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIERuc1JlY29yZEFuYW1lIGV4dGVuZHMgRG5zUmVjb3JkQmFzZSB7XG4gICAgdHlwZTogXCJBTkFNRVwiO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIERuc1JlY29yZE1YIGV4dGVuZHMgRG5zUmVjb3JkQmFzZSB7XG4gICAgdHlwZTogXCJNWFwiO1xuICAgIHByaW9yaXR5OiBudW1iZXI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRG5zUmVjb3JkU1JWIGV4dGVuZHMgRG5zUmVjb3JkQmFzZSB7XG4gICAgdHlwZTogXCJTUlZcIjtcbiAgICBwcmlvcml0eTogbnVtYmVyO1xuICAgIHdlaWdodDogbnVtYmVyO1xuICAgIHBvcnQ6IG51bWJlcjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBEbnNSZWNvcmRUTFNBIGV4dGVuZHMgRG5zUmVjb3JkQmFzZSB7XG4gICAgdHlwZTogXCJUTFNBXCI7XG4gICAgdXNhZ2U6IG51bWJlcjtcbiAgICBzZWxlY3RvcjogbnVtYmVyO1xuICAgIGR0eXBlOiBudW1iZXI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRG5zUmVjb3JkRFMgZXh0ZW5kcyBEbnNSZWNvcmRCYXNlIHtcbiAgICB0eXBlOiBcIkRTXCI7XG4gICAgdGFnOiBudW1iZXI7XG4gICAgYWxnOiBudW1iZXI7XG4gICAgZGlnZXN0OiBudW1iZXI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRG5zUmVjb3JkQ0FBIGV4dGVuZHMgRG5zUmVjb3JkQmFzZSB7XG4gICAgdHlwZTogXCJDQUFcIjtcbiAgICBmbGFnczogbnVtYmVyO1xuICAgIHRhZzogbnVtYmVyO1xufVxuXG5leHBvcnQgdHlwZSBEbnNSZWNvcmQgPSBEbnNSZWNvcmRBIHwgRG5zUmVjb3JkQUFBQSB8IERuc1JlY29yZENuYW1lIHwgRG5zUmVjb3JkQW5hbWUgfCBEbnNSZWNvcmRNWCB8IERuc1JlY29yZFNSViB8IERuc1JlY29yZFRMU0EgfCBEbnNSZWNvcmREUyB8IERuc1JlY29yZENBQTtcblxuXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGUocGFyYW1zOkRuc1JlY29yZCkge1xuICAgIGNvbnN0IGNvbW1vbjpzdHJpbmdbXSA9IFsnaG9zdCcsJ2RhdGEnLCd0eXBlJ107XG4gICAgY29uc3QgdHlwZXM6e1tpbmRleDpzdHJpbmddOiBzdHJpbmdbXX0gPSB7XG4gICAgICAgICdNWCc6IFsncHJpb3JpdHknXSxcbiAgICAgICAgJ1NSVic6IFsncHJpb3JpdHknLCd3ZWlnaHQnLCdwb3J0J10sXG4gICAgICAgICdUTFNBJzogWyd1c2FnZScsICdzZWxlY3RvcicsICdkdHlwZSddLFxuICAgICAgICAnRFMnOiBbJ3RhZycsJ2FsZycsJ2RpZ2VzdCddLFxuICAgICAgICAnQ0FBJzogWydmbGFncycsJ3RhZyddXG4gICAgfTtcblxuICAgIGlmKCFwYXJhbXMuaGFzT3duUHJvcGVydHkoXCJ0eXBlXCIpKVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJSZWNvcmQgZG9lcyBub3QgaGF2ZSBhbnkgdHlwZVwiKTtcbiAgICBpZighdHlwZXMuaGFzT3duUHJvcGVydHkocGFyYW1zLnR5cGUpKVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJSZWNvcmQgaGF2ZSBhbiB1bmtub3duIHR5cGVcIik7XG5cbiAgICBsZXQgZmllbGRzID0gY29tbW9uO1xuICAgIGxldCBzcGVjaWFsOnN0cmluZ1tdID0gdHlwZXNbcGFyYW1zLnR5cGVdO1xuICAgIGZpZWxkcy5jb25jYXQoc3BlY2lhbCk7XG5cbiAgICBpZihwYXJhbXMuaGFzT3duUHJvcGVydHkoJ2lkJykpXG4gICAgICAgIGZpZWxkcy5wdXNoKCdpZCcpO1xuICAgIGlmKHBhcmFtcy5oYXNPd25Qcm9wZXJ0eSgndHRsJykpXG4gICAgICAgIGZpZWxkcy5wdXNoKCd0dGwnKTtcblxuICAgIGZvcihsZXQgaWR4PTA7IGlkeCA8IGZpZWxkcy5sZW5ndGg7IGlkeCsrKSB7XG4gICAgICAgIGlmKCFwYXJhbXMuaGFzT3duUHJvcGVydHkoZmllbGRzW2lkeF0pKVxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUmVjb3JkIG1pc3NpbmcgcmVxdWlyZWQgZmllbGRcIik7XG4gICAgfVxuXG4gICAgaWYoZmllbGRzLmxlbmd0aCA8IE9iamVjdC5rZXlzKHBhcmFtcykua2V5cy5sZW5ndGgpXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIlRvbyBtYW55IGZpZWxkcyBpbiBvYmplY3RcIik7XG5cbiAgICByZXR1cm4gdHJ1ZTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgRG5zUmVjb3JkO1xuIl19